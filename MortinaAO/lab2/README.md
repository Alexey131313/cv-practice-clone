# Практическая работа №2. Детектирование объектов на изображениях с использованием библиотеки OpenCV

Программа реализует систему обнаружения объектов на основе предобученной модели SSD MobileNet с использованием библиотеки OpenCV.

## Предварительная обработка изображений

Перед тем как изображение передаётся модели, оно должно быть преобразовано в формат, понятный нейронной сети. Для этого был реализован следующий алгоритм:

### Чтение изображения

Система считывает изображение из файла, что обеспечивает загрузку изображения в виде массива пикселей в формате BGR.

### Преобразование изображения в тензор

Для подготовки изображения используется функция create_input_tensor(), которая выполняет:
1. Масштабирование изображения до фиксированного размера.
2. Нормализация интенсивности пикселей, чтобы привести значения в необходимый диапазон.
3. Изменение цветового пространства с BGR на RGB.
4. Создание тензора с помощью cv.dnn.blobFromImage, готового для передачи в нейронную сеть.

## Обработка выхода сети

После того как тензор передаётся модели, она возвращает массив предсказаний. Для интерпретации результатов было реализовано:

### Получение предсказаний

Функция fetch_predictions(): gередаёт входные данные в модель через model.setInput(blob) и получает предсказания с помощью model.forward().

Результат — многомерный массив, где каждая запись содержит: уверенность детекции, нормализованные координаты ограничивающего прямоугольника и индекс класса обнаруженного объекта.

### Постобработка результатов

Функция process_predictions() обрабатывает результаты, возвращённые сетью:
1. Фильтрация объектов: отбираются только предсказания с уверенностью выше заданного порога (confidence_threshold).
2. Масштабирование координат: нормализованные координаты прямоугольников преобразуются в пиксели на основе размеров изображения.
3. Назначение класса: идентификатор класса сопоставляется с его названием из списка CLASSES.
4. Визуализация: для каждого объекта рисуется прямоугольник и выводится название класса с уровнем уверенности.

Дополнительно ведётся подсчёт объектов каждого класса, сохраняемый в словаре detected.

## Обработка изображений и видео

1. Изображения (handle_image()): выполняется загрузка, обработка и вывод результата с отмеченными объектами.
2. Видео (handle_video()): кадр за кадром выполняется обработка с отображением результатов в реальном времени.

Таким образом, алгоритмы предварительной обработки изображений и обработки выхода сети обеспечивают эффективную работу системы детекции объектов:
Предварительная обработка преобразует изображение в формат, подходящий для модели, нормализуя его и улучшая точность предсказаний.
И обработка выхода сети фильтрует и визуализирует предсказания, упрощая интерпретацию результатов.